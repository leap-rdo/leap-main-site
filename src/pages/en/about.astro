---
import Base from "@/layouts/Base.astro";
import AboutBanner from "@/partials/AboutBanner.astro";
import CallToAction from "@/partials/CallToAction.astro";
import Partners from "@/partials/Partners.astro";
import Faq from "@/partials/Faq.astro";
import OurTeamSummary from "@/partials/OurTeamSummary.astro";
import WhyUs from "@/partials/WhyUs.astro";
import OurValues from "@/partials/OurValues.astro";
import type { CollectionEntry } from "astro:content";
import { getEntry } from "astro:content";
import {
  getLangFromUrl,
  useTranslations,
  useTranslatedPath,
} from "@/i18n/utils";
import fetchApi from "@/lib/strapi";
import type About from "@/interfaces/about";

const lang = getLangFromUrl(Astro.url);
const data = await fetchApi<About>({
  endpoint: "about",
  wrappedByKey: "data",
  query: { locale: lang, populate: "*" },
});

const about = (await getEntry("about", "-index")) as CollectionEntry<"about">;
const { title, description, meta_title, image } = about.data;
---

<Base
  title={title}
  meta_title={meta_title}
  description={description}
  image={image}>
  <WhyUs content={data.whyUs} />
  <Partners />
  <OurValues
    vision={data.vision}
    mission={data.mission}
    whoWeServe={data.whoWeServe}
  />
  <OurTeamSummary />
  <CallToAction />
</Base>
